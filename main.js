(()=>{"use strict";const e=(()=>{const e=document.getElementById("player-board"),t=document.getElementById("computer-board"),a=document.getElementById("axis-button"),i=document.querySelectorAll(".ship"),s=document.querySelectorAll(".square-ship-place");function o(){setTimeout((()=>this.className="invisible"),0),this.setAttribute("id","dragging")}function n(){this.className="ship",this.removeAttribute("id","dragging")}function d(e){e.preventDefault()}function h(e){e.preventDefault(),this.className="hovered-square"}function l(){this.className="player-square-empty"}function c(){const e=document.getElementById("dragging"),t=e.getAttribute("length");let a=this.getAttribute("index");a=parseFloat(a),r.placeShipProcess(a,t)?(this.append(e),this.innerHTML="",e.removeAttribute("id")):this.className="player-square-empty"}return{updateBoards:(a,i,s)=>{e.innerHTML="",t.innerHTML="",a.forEach(((t,a)=>{t.hasShip&&t.isHit?e.innerHTML+=`<div class="player-hitsquare-ship" index="${a}"></div>`:t.hasShip?e.innerHTML+=`<div class="player-square-ship" index="${a}"></div>`:t.isHit?e.innerHTML+=`<div class="player-hitsquare-empty" index="${a}"></div>`:e.innerHTML+=`<div class="player-square-empty" index="${a}"></div>`})),i.forEach(((e,a)=>{e.hasShip&&e.isHit?t.innerHTML+=`<div class="computer-hitsquare-ship" index="${a}"></div>`:e.isHit?t.innerHTML+=`<div class="computer-hitsquare-empty" index="${a}"></div>`:t.innerHTML+=`<div class="computer-square-empty" index="${a}"></div>`})),s&&document.querySelectorAll(".computer-square-empty").forEach((e=>e.addEventListener("click",r.makeAttack)))},axisEventListener:()=>{a.addEventListener("click",(e=>{"x"===e.target.getAttribute("value")?(e.target.setAttribute("value","y"),e.target.textContent="Y - AXIS",i.forEach((e=>e.style.flexDirection="column")),s.forEach((e=>e.style.marginBottom="10px"))):(e.target.setAttribute("value","x"),e.target.textContent="X - AXIS",i.forEach((e=>e.style.flexDirection="row")),s.forEach((e=>e.style.marginRight="10px")))}))},getAxis:()=>a.getAttribute("value"),placeShipEvent:()=>{const e=document.querySelectorAll(".ship"),t=document.querySelectorAll(".player-square-empty");e.forEach((e=>{e.addEventListener("dragstart",o),e.addEventListener("dragend",n)})),t.forEach((e=>{e.addEventListener("dragover",d),e.addEventListener("dragenter",h),e.addEventListener("dragleave",l),e.addEventListener("drop",c)}))},getAllMoves:()=>{const{children:t}=e;return Array.from(t).filter((e=>"player-hitsquare-empty"!==e.getAttribute("class")))}}})();class t{constructor(e){this.name=e,this.turn=!0,this.gameBoard=new class{constructor(e){this.board=e||[],this.ships=[],this.board.length||this.init()}init(){for(let e=0;e<100;e+=1)this.board.push({hasShip:!1,isHit:!1,ship:null})}createLocationArray(e,t,a){const r=[];for(let i=0;i<t;i+=1)"x"===a?r.push(e+i):r.push(e+10*i);return r}checkCollisions(e){return!!e.some((e=>!this.board[e]))||!!e.some((e=>this.board[e].hasShip))||!![9,19,29,39,49,59,69,79,89].some((t=>[t,t+1].every((t=>e.includes(t)))))}placeShip(e){const t=new class{constructor(e,t){this.length=e,this.coordinates=t,this.hitSpots=[],this.hasSunk=!1}hit(e){this.hitSpots.push(parseFloat(e))}isSunk(){return this.hitSpots.length===this.length}}(e.length,e);this.ships.push(t);for(let a=0;a<e.length;a+=1)this.board[e[a]].hasShip=!0,this.board[e[a]].ship=t}receiveAttack(e){this.board[e].isHit=!0,this.board[e].hasShip&&(this.board[e].ship.hit(e),this.board[e].ship.isSunk()&&(this.board[e].ship.hasSunk=!0))}haveAllShipsSunk(){return!!this.ships.every((e=>e.isSunk()))}}}fireShot(e,t){t.receiveAttack(e)}}class a extends t{pickAIMove(e){return e[Math.floor(Math.random()*e.length)].getAttribute("index")}getAllShipSpots(e){return e.filter((e=>!e.hasShip))}}const r=(()=>{let r,i;return{setUpGame:()=>{r=new t("Player"),i=new a("AI"),e.updateBoards(r.gameBoard.board,i.gameBoard.board),e.axisEventListener(),e.placeShipEvent()},placeShipProcess:(t,a)=>{const s=e.getAxis(),o=r.gameBoard.createLocationArray(t,a,s);return!r.gameBoard.checkCollisions(o)&&(r.gameBoard.placeShip(o),e.updateBoards(r.gameBoard.board,i.gameBoard.board),e.placeShipEvent(),17===r.gameBoard.board.filter((e=>e.hasShip)).length&&(()=>{const t=[5,4,3,3,2];for(let a=0;a<5;a+=1){let s="";s=0===Math.floor(2*Math.random())?"x":"y";let o=i.getAllShipSpots(i.gameBoard.board),n=Math.floor(Math.random()*o.length),d=t[a],h=i.gameBoard.createLocationArray(n,d,s);if(i.gameBoard.checkCollisions(h)){let l=!1;for(;!1===l;)o=i.getAllShipSpots(i.gameBoard.board),n=Math.floor(Math.random()*o.length),d=t[a],h=i.gameBoard.createLocationArray(n,d,s),i.gameBoard.checkCollisions(h)||(i.gameBoard.placeShip(h),e.updateBoards(r.gameBoard.board,i.gameBoard.board),l=!0)}else i.gameBoard.placeShip(h),e.updateBoards(r.gameBoard.board,i.gameBoard.board)}e.updateBoards(r.gameBoard.board,i.gameBoard.board,!0)})(),!0)},makeAttack:t=>{const a=t.target.getAttribute("index");i.gameBoard.receiveAttack(a),function(){const t=e.getAllMoves(),a=i.pickAIMove(t);r.gameBoard.receiveAttack(a)}(),e.updateBoards(r.gameBoard.board,i.gameBoard.board,!0),r.gameBoard.haveAllShipsSunk()?alert("AI Wins"):i.gameBoard.haveAllShipsSunk()&&alert("Player Wins")}}})();r.setUpGame()})();